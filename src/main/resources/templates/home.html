<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="refresh" content="30" > <!-- refresh page every x seconds -->
        <title>Urchin Release Mgt: Home</title>

        <link rel="icon" href="/img/favicon.png">
        <link rel="stylesheet" href="/css/bootstrap.min.css">
        <link rel="stylesheet" href="/css/style.css">
        <script src="/js/jquery-3.3.1.min.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        <script src="/js/Chart.min.js"></script>
    </head>
    <body class="p-3 mb-2 bg-dark text-white">
        <div th:replace="fragments/menu :: menu">&nbsp;</div>

        <table class="table table-dark table-bordered">
            <tbody>
                <tr>
                    <td>
                        <div class="homeCharts">
                            <canvas id="issuesChart"></canvas>
                        </div>
                    </td>
                    <td>
                        <div class="homeCharts">
                            <canvas id="downloadChart"></canvas>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div class="homeCharts">
                            <canvas id="appVersionCheckChart"></canvas>
                        </div>
                    </td>
                    <td>
                        <div class="homeCharts"></div>
                    </td>
                </tr>
            </tbody>
        </table>

        <script th:inline="javascript">
            var issueChartLabels = /*[[${issueChartDates}]]*/ ['unknown'];
            var issueChartValues = /*[[${issueChartValues}]]*/ [0];
            new Chart(document.getElementById("issuesChart"), {
                type: 'bar',
                data: {
                    labels: issueChartLabels,
                    datasets: [{
                        data: issueChartValues,
                        label: "Issues",
                        backgroundColor: "#ff7b00",
                        fill: true
                    }]
                },
                options: {
                    maintainAspectRatio: true,
                    animation: false,
                    legend: {
                        display: false
                    },
                    title: {
                        display: true,
                        text: 'Number of issues'
                    }
                }
            });

            var downloadChartLabels = /*[[${downloadChartDates}]]*/ ['unknown'];
            var downloadLinuxTarChartValues = /*[[${issueChartValues}]]*/ [0];
            var downloadLinuxDebChartValues = /*[[${issueChartValues}]]*/ [0];
            var downloadWindowChartValues = /*[[${issueChartValues}]]*/ [0];
            new Chart(document.getElementById("downloadChart"), {
                type: 'line',
                data: {
                    labels: downloadChartLabels,
                    datasets: [{
                        data: downloadLinuxTarChartValues,
                        label: "Linux (tar)",
                        borderColor: "#007bff",
                        steppedLine: true,
                        fill: false
                    },{
                        data: downloadLinuxDebChartValues,
                        label: "Linux (deb)",
                        borderColor: "#ff007b",
                        steppedLine: true,
                        fill: false
                    },{
                        data: downloadWindowChartValues,
                        label: "Windows",
                        borderColor: "#7bff00",
                        steppedLine: true,
                        fill: false
                    }]
                },
                options: {
                    maintainAspectRatio: true,
                    animation: false,
                    legend: {
                        display: true
                    },
                    title: {
                        display: true,
                        text: 'Number of download'
                    }
                }
            });

            var appVersionCheckChartLabels = /*[[${appVersionCheckChartDates}]]*/ ['unknown'];
            var appVersionCheckChartValues = /*[[${issueChartValues}]]*/ [0];
            new Chart(document.getElementById("appVersionCheckChart"), {
                type: 'line',
                data: {
                    labels: appVersionCheckChartLabels,
                    datasets: [{
                        data: appVersionCheckChartValues,
                        label: "",
                        borderColor: "#7b00ff",
                        fill: false
                    }]
                },
                options: {
                    animation: false,
                    maintainAspectRatio: true,
                    legend: {
                        display: false
                    },
                    title: {
                        display: true,
                        text: 'Application version check'
                    }
                }
            });
        </script>
    </body>
</html>