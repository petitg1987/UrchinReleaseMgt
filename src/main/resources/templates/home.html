<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta http-equiv="refresh" content="60" > <!-- refresh page every x seconds -->
        <title>Urchin Release Mgt: Home</title>

        <link rel="icon" href="/img/favicon.png">
        <link rel="stylesheet" href="/css/bootstrap.min.css">
        <link rel="stylesheet" href="/css/style.css">
        <script src="/js/jquery-3.3.1.min.js"></script>
        <script src="/js/bootstrap.min.js"></script>
        <script src="/js/Chart.min.js"></script>
    </head>
    <body class="p-3 mb-2 bg-dark text-white">
        <div th:replace="fragments/menu :: menu"></div>

        <div class="d-flex flex-wrap" style="background-color: #2c3034;">
            <div class="homeCharts mr-auto">
                <canvas id="issuesChart"></canvas>
            </div>
            <div class="homeCharts mr-auto">
                <canvas id="downloadChart"></canvas>
            </div>
            <div class="homeCharts mr-auto">
                <canvas id="appVersionCheckChart"></canvas>
            </div>
        </div>

        <script th:inline="javascript">
            var issueChartLabels = /*[[${issueChartDates}]]*/ ['unknown'];
            var issueChartValues = /*[[${issueChartValues}]]*/ [0];
            new Chart(document.getElementById("issuesChart"), {
                type: 'bar',
                data: {
                    labels: issueChartLabels,
                    datasets: [{
                        data: issueChartValues,
                        label: "Issues",
                        backgroundColor: "#d07b00",
                        fill: true
                    }]
                },
                options: {
                    maintainAspectRatio: true,
                    animation: false,
                    legend: {
                        display: false
                    },
                    title: {
                        display: true,
                        text: 'Number of issues'
                    }
                }
            });

            var downloadChartLabels = /*[[${downloadChartDates}]]*/ ['unknown'];
            var downloadLinuxTarChartValues = /*[[${downloadLinuxTarChartValues}]]*/ [0];
            var downloadLinuxDebChartValues = /*[[${downloadLinuxDebChartValues}]]*/ [0];
            var downloadWindowsChartValues = /*[[${downloadWindowsChartValues}]]*/ [0];
            new Chart(document.getElementById("downloadChart"), {
                type: 'bar',
                data: {
                    labels: downloadChartLabels,
                    datasets: [{
                        data: downloadLinuxTarChartValues,
                        label: "Linux (tar)",
                        backgroundColor: "#007bff",
                        fill: true
                    },{
                        data: downloadLinuxDebChartValues,
                        label: "Linux (deb)",
                        backgroundColor: "#ff007b",
                        fill: true
                    },{
                        data: downloadWindowsChartValues,
                        label: "Windows",
                        backgroundColor: "#7bd000",
                        fill: true
                    }]
                },
                options: {
                    maintainAspectRatio: true,
                    animation: false,
                    legend: {
                        display: true
                    },
                    title: {
                        display: true,
                        text: 'Number of download'
                    }
                }
            });

            var appVersionCheckChartLabels = /*[[${appVersionCheckChartDates}]]*/ ['unknown'];
            var appVersionCheckChartValues = /*[[${appVersionCheckChartValues}]]*/ [0];
            new Chart(document.getElementById("appVersionCheckChart"), {
                type: 'line',
                data: {
                    labels: appVersionCheckChartLabels,
                    datasets: [{
                        data: appVersionCheckChartValues,
                        label: "App. version check",
                        borderColor: "#7b00ff",
                        fill: false,
                        lineTension: 0
                    }]
                },
                options: {
                    animation: false,
                    maintainAspectRatio: true,
                    legend: {
                        display: false
                    },
                    title: {
                        display: true,
                        text: 'Application version check'
                    }
                }
            });
        </script>
    </body>
</html>